expressway<- readOGR(dsn = 'RoadNetwork', layer = 'roads_expressway_simplified')
# Create accidents ppp
accidents <- readOGR('final_data', 'accidents')
accidents_sp <- as(accidents, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,1,0.2))
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools', 'rgeos')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
expressway<- readOGR(dsn = 'RoadNetwork', layer = 'roads_expressway_simplified')
# Create accidents ppp
accidents <- readOGR('final_data', 'accidents')
accidents_sp <- as(accidents, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,1,0.2))
plot(density.lpp(accidents_lpp, 100))
View(accidents)
View(accidents)
View(accidents)
View(accidents)
View(accidents)
View(accidents)
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools', 'rgeos')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
expressway<- readOGR(dsn = 'RoadNetwork', layer = 'roads_expressway_simplified')
# Create accidents ppp
accidents <- readOGR('test', 'accidents2')
accidents_sp <- as(accidents, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 100))
# Create accidents ppp
accidents <- read_csv('test/accidents.csv')
accidents
# Create accidents ppp
accidents <- read_csv('test/accidents.csv')
SpatialPoints(accidents$X, accidents$Y)
SpatialPoints((accidents$X, accidents$Y), proj4string = '+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs ')
?SpatialPoints
SpatialPoints(cbind(accidents$X, accidents$Y), proj4string = '+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs ')
SpatialPoints(cbind(accidents$X, accidents$Y), proj4string = CRS(3414))
SpatialPoints(cbind(accidents$X, accidents$Y), proj4string = CRS('3414'))
SpatialPoints(cbind(accidents$X, accidents$Y))
proj4string(accidents_sp) <- '+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs '
#accidents_sp <- as(accidents, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 100))
accidents_ppp <- ppp(accidents[,1], accidents[,2], c(min(accidents[,1]), max(accidents[,1])), c(min(accidents[,2]), max(accidents[,2])))
min(accidents[,1])
accidents[,1]
# Create accidents ppp
accidents <- read.csv('test/accidents.csv')
accidents_ppp <- ppp(accidents[,1], accidents[,2], c(min(accidents[,1]), max(accidents[,1])), c(min(accidents[,2]), max(accidents[,2])))
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 100))
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools', 'rgeos')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
expressway<- readOGR(dsn = 'RoadNetwork', layer = 'roads_expressway_simplified')
# Create accidents ppp
accidents <- read.csv('test/accidents.csv')
accidents_sp <- SpatialPoints(cbind(accidents$X, accidents$Y))
proj4string(accidents_sp) <- '+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs '
#accidents_sp <- as(accidents, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
accidents_ppp <- ppp(accidents[,1], accidents[,2], c(min(accidents[,1]), max(accidents[,1])), c(min(accidents[,2]), max(accidents[,2])))
# Create expressway linnet
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 100))
plot(density.lpp(accidents_lpp, 1000))
plot(density.lpp(accidents_lpp, 20))
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools', 'rgeos')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
expressway<- readOGR(dsn = 'RoadNetwork', layer = 'roads_expressway_simplified')
analysis_area <- 'PIE'
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
#expressway_subset <- expressway[expressway@data[['ref']] == analysis_area,]
expressway_subset <- expressway
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
expressway_subset <- expressway[expressway@data[['ref']] %in% c('PIE', 'BKE'),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'ECP',
'KJE',
'KPE',
'MCE',
'PIE',
'SLE',
'TPE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'ECP',
'KJE',
'KPE',
'MCE',
'PIE',
'SLE',
),]
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'ECP',
'KJE',
'KPE',
'MCE',
'PIE',
'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'ECP',
'KJE',
'KPE',
'PIE',
'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'KJE',
'KPE',
'PIE',
'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c('AYE',
'BKE',
'CTE',
'PIE',
'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE',
'CTE',
'PIE',
'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
#Prepare expressway
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE',
'CTE',
),]
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE',
'CTE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
#Prepare expressway
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE', 'SLE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'BKE', 'SLE', 'CTE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
#Prepare expressway
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'CTE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
#Prepare expressway
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'CTE', 'BKE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
expressway_subset <- expressway[expressway@data[['ref']] %in% c(
'SLE', 'BKE', 'AYE', 'PIE'
),]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp, sparse = TRUE)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
plot(expressway_subset_linnet)
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 100))
plot(density.lpp(accidents_lpp, 100))
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway2", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
?gsimplify
?gSimplify
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork<- gSimplify(roadNetwork, tol = 100)
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork<- gSimplify(roadNetwork, tol = 1)
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork<- gSimplify(roadNetwork, tol = 0.1)
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork<- gSimplify(roadNetwork, tol = 0.01)
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
# Create expressway linnet
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
plot(density.lpp(accidents_lpp, 1000))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- gSimplify(roadNetwork, tol = 1000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.01,0.002)))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- gSimplify(roadNetwork, tol = 1000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.01,0.002)))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- gSimplify(roadNetwork, tol = 1000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.0001,0.00002)))
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- gSimplify(roadNetwork, tol = 100000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.000001,0.0000002)))
shiny::runApp('C:/Users/vince/Google Drive/3.4 SMU/3.2 Geospatial/Week 12/063-superzip-example/063-superzip-example')
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools', 'rgeos')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork <- gSimplify(roadNetwork, tol = 100000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.000001,0.0000002)))
library(SpatialEpiApp)
install.packages(SpatialEpiApp)
install.packages('SpatialEpiApp')
library(SpatialEpiApp)
SpatialEpiApp
SpatialEpiApp::run_app()
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
#accidents_subset <- accidents[accidents@data[['Accident_L']] == analysis_area,]
accidents_subset <- accidents
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
roadNetwork <- readShapeSpatial("test/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
# simplify road network
roadNetwork <- gSimplify(roadNetwork, tol = 100000 )
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
# Create lpp
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
system.time(envelope.lpp(accidents_lpp,linearK, nsim = 3, r=seq(0,0.000001,0.0000002)))
