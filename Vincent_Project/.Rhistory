class(hms('2:22:22'))
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
data <- read_csv('csv/LTATrafficDataClean2.csv')
dataSF <- st_as_sf(data, coords =c( 'Longitude', 'Latitude') , crs = '+proj=longlat +datum=WGS84 +no_defs')
expressway<- readShapeSpatial('RoadNetwork/roads_expressway')
sgmap <- st_read('data.gov.sg/planningArea', 'MP14_PLNG_AREA_WEB_PL')
dataSF_svy21 <- st_transform(dataSF, 3414)
accidents <- dataSF_svy21 %>% filter(Type == 'Accident')
tm_shape(sgmap) + tm_borders()  + tm_shape(accidents) + tm_symbols(size = 0.5)
st_write(accidents, "csv/accidents.csv", layer_options = "GEOMETRY=AS_XY")
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
data <- read_csv('csv/LTATrafficDataClean2.csv')
dataSF <- st_as_sf(data, coords =c( 'Longitude', 'Latitude') , crs = '+proj=longlat +datum=WGS84 +no_defs')
expressway<- readShapeSpatial('RoadNetwork/roads_expressway')
sgmap <- st_read('data.gov.sg/planningArea', 'MP14_PLNG_AREA_WEB_PL')
dataSF_svy21 <- st_transform(dataSF, 3414)
accidents <- dataSF_svy21 %>% filter(Type == 'Accident')
tm_shape(sgmap) + tm_borders()  + tm_shape(accidents) + tm_symbols(size = 0.5)
st_write(accidents, "csv/accidents.csv", layer_options = "GEOMETRY=AS_XY")
sgroad <- st_read('RoadNetwork', 'roads_exp_join')
View(sgroad)
sgroad_pln <- st_join(sgroad, sgmap)
sgroad
sgroad <- st_transform(sgroad, 3414)
sgroad
CRS(sgroad)
st_crs(sgroad)
st_crs(sgmap)
sgmap
st_crs(sgroad) <- 3414
st_crs(sgmap) <- 3414
sgmap
sgroad
sgroad_pln <- st_join(sgroad, sgmap)
View(sgroad_pln)
View(sgroad)
glimpse(sgroad_pln)
sgroad_pln_short <- sgroad_pln %>% filter(osm_id, name, ref, type, oneway, bridge, maxspeed, RoadType, PLN_AREA_C, PLN_AREA_N, REGION_C, REGION_N)
sgroad_pln_short <- sgroad_pln %>% filter(osm_id)
sgroad_pln_short <- sgroad_pln %>% select(osm_id, name, ref, type, oneway, bridge, maxspeed, RoadType, PLN_AREA_C, PLN_AREA_N, REGION_C, REGION_N)
View(sgroad_pln_short)
st_write(sgroad_pln_short, 'sgroad_joined.shp')
View(sgroad_pln_short)
View(sgroad_pln)
?strptime
View(sgroad_pln_short)
View(dataSF_svy21)
as.POSIXlt('23:54:00')
?data
data(GR.Hospitals)
packages = c('tidyverse', 'REAT', 'SpatialAcc')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
data(PWC.Municipalities)
data(GR.Hospitals)
head(PWC.Municipalities)
GR.H_Coords <-cbind(GR.Hospitals$X,GR.Hospitals$Y)
GR.M_Coords <-cbind(PWC.Municipalities$pwX,PWC.Municipalities$pwY)
GR.d <- distance(GR.M_Coords, GR.H_Coords) #returns m
GR.d100 <- GR.d / 100000 #to reduce the length of the distance, so that calculation will be faster - to standardise data , otherwise if range too big, not good
GR.acc <- ac(PWC.Municipalities$Pop, GR.Hospitals$Beds15, GR.d100, d0 = 50000, power = 2, family = 'SAM')
GR.acc1 <- data.frame(PWC.Municipalities[,c(1,5,6)],
GR.acc)
library(leaflet)
m= leaflet(GR.acc1) %>% addTiles() %>%
setView(23, 39, zoom = 6) %>%
addCircles(lng= ~Lon, lat= ~Lat, weight= 1,
radius = ~sqrt(GR.acc) * 10,
popup = ~KallCode)
m
GR.HospitalDF <- as.data.frame(GR.Hospitals)
GR.dist <- dist.mat(PWC.Municipalities, "KallCode",
"pwY", "pwX", GR.HospitalDF,
"Name", "Y", "X", unit = "km")
GR.joined <- left_join(GR.dist, GR.HospitalDF,
c("to"="Name"))
GR.hansen <- hansen(GR.joined, "from", "to",
"Beds15", "distance", gamma = 1,
lambda = -2, atype = "pow",
dtype = "pow")
library(sf)
dataSF <- st_as_sf(GR.acc1, coords =c( 'Lon', 'Lat') , crs = '+proj=longlat +datum=WGS84 +no_defs')
tmap_mode("view")
library(REAT)
?data
data("GR.Hospitals")
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
data <- read_csv('csv/LTATrafficDataClean2.csv')
dataSF <- st_as_sf(data, coords =c( 'Longitude', 'Latitude') , crs = '+proj=longlat +datum=WGS84 +no_defs')
expressway<- readShapeSpatial('RoadNetwork/roads_expressway')
sgmap <- st_read('data.gov.sg/planningArea', 'MP14_PLNG_AREA_WEB_PL')
dataSF_svy21 <- st_transform(dataSF, 3414)
accidents <- dataSF_svy21 %>% filter(Type == 'Accident')
tm_shape(sgmap) + tm_borders()  + tm_shape(accidents) + tm_symbols(size = 0.5)
st_write(accidents, "csv/accidents.csv", layer_options = "GEOMETRY=AS_XY")
accidents_xy <- read.csv('csv/accidents.csv')
accidents_ppp <- ppp(accidents_xy[,1], accidents_xy[,2], c(min(accidents_xy[,1]), max(accidents_xy[,1])), c(min(accidents_xy[,2]), max(accidents_xy[,2])))
plot(accidents_ppp)
summary(accidents_ppp)
plot(Kest(accidents_ppp))
plot(envelope(accidents_ppp,Kest))
plot(density(accidents_ppp))
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 1000))
iplot(density.lpp(accidents_lpp, 1000))
install.packages('rpanel')
library(rpanel)
iplot(density.lpp(accidents_lpp, 1000))
packages = c('rgdal', 'maptools', 'spatstat')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
?c
?readOGR
childcare <- readOGR('Hands-on09', 'CHILDCARE_WL' )
packages = c('rgdal', 'maptools', 'spatstat')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
childcare <- readOGR('Hands-on09', 'CHILDCARE_WL' )
childcare <- readOGR('Hands-on09', 'CHILDCARE_WL' )
woodlands <- readOGR('Hands-on09', 'WOODLANDS' )
View(woodlands)
View(childcare)
View(childcare)
View(childcare)
childcare <- readOGR('Hands-on09', 'CHILDCARE_WL' )
woodlands <- readOGR('Hands-on09', 'WOODLANDS' )
class(childcare)
str(childcare)
packages = c('rgdal', 'maptools', 'spatstat')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
childcare <- readOGR('Hands-on09','CHILDCARE_WL' )
woodlands <- readOGR('Hands-on09', 'WOODLANDS' )
str(childcare)
View(childcare)
View(childcare)
View(childcare)
View(childcare)
View(woodlands)
View(woodlands)
head(childcare)
childcare@data
childcare@data$X_ADDR
childcare@data[c('X_ADDR')]
childcare@data[c('X_ADDR', 'Y_ADDR') ]
qtm(childcare)
plot(childcare)
plot(woodlands)
?as.ppp
?ppp
childcare_ppp <- ppp(childcare@data$X_ADDR, childcare@data$Y_ADDR)
childcare <- readOGR('data','CHILDCARE_WL' )
woodlands <- readOGR('data', 'WOODLANDS' )
View(childcare_ppp)
plot(childcare_ppp)
woodlands_owin <- as.owin(woodlands)
?ppp
childcare_ppp <- ppp(childcare@data$X_ADDR, childcare@data$Y_ADDR, woodlands_owin)
childcare_sp <- as(childcare, 'SpatialPoints')
woodlands_sp <- as(woodlands, 'SpatialPolygon')
childcare_sp <- as(childcare, 'SpatialPoints')
woodlands_sp <- as(woodlands, 'SpatialPolygons')
str(woodlands_sp)
View(childcare_sp)
quadratcount(childcare_ppp)
x <- quadratcount(childcare_ppp)
intensity.quadratcount(x)
plot(intensity.quadratcount(x))
plot(intensity.quadratcount(x, image = TRUE))
quadrat.test(childcare_ppp)
quadrat.test(childcare_ppp,5,4)
quadrat.test(childcare_ppp, 5 ,4 )
qc <- quadratcount(childcare_ppp, 5 , 4 )
qc
plot(qc)
plot(intensity.quadratcount(qc, image = TRUE))
plot(intensity.quadratcount(qc, image = TRUE))
plot(intensity.quadratcount(x, image = TRUE))
plot(x)
plot(qc)
childcare_ppp <- as.ppp(childcare_sp)
w <- as.owin(woodlands_sp)
qc <- quadratcount(childcare_ppp, 5 , 4 )
quadrat.test(childcare_ppp, 5 ,4 )
plot(intensity.quadratcount(qc, image = TRUE))
quadrat.test(childcare_ppp,5,4)
nnd <- nndist(childcare_ppp)
hist(nnd)
clarkevans.test(childcare_ppp)
nnd <- nndist(childcare_ppp)
hist(nnd)
clarkevans.test(childcare_ppp)
g <- Gest(childcare_ppp)
g
plot(g)
G.csr <- envelope(childcare_ppp, Gest, nsim = 99, rank = 1, glocal = TRUE)
plot(G.csr)
G.csr <- envelope(childcare_ppp, Gest, nsim = 999, rank = 1, glocal = TRUE)
plot(G.csr)
G.csr <- envelope(childcare_ppp, Gest, nsim = 99, rank = 1, glocal = TRUE)
plot(G.csr, xlim = c(0,500))
k <- Kest(childcare_ppp)
plot(k, xlim  = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 99, rank = 1, glocal = TRUE)
plot(G.csr, xlim = c(0,500))
?envelope
G.csr <- envelope(childcare_ppp, Kest, nsim = 99, rank = 1, glocawl = TRUE)
plot(G.csr, xlim = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 99, rank = 1, glocal = TRUE)
plot(G.csr, xlim = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 99, rank = 1, glocal = TRUE)
plot(G.csr, xlim = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 999, rank = 1, glocal = TRUE)
plot(G.csr, xlim = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 999)
plot(G.csr, xlim = c(0,500))
G.csr <- envelope(childcare_ppp, Kest, nsim = 999)
plot(G.csr, xlim = c(0,500))
# nearby cluster, 100 - 250 random,
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 100)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 1)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 1000)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 100)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 50)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
kde_sp_100 <- density(childcare_ppp, 100)
# why 100? bcos based on the k function? 100m seems to be random , so try 100
plot(kde_sp_100)
K.csr <- envelope(childcare_ppp, Kest, nsim = 999)
plot(K.csr, xlim = c(0,500))
# nearby cluster, 100 - 250 random, beyond clustered
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
data <- read_csv('csv/LTATrafficDataClean2.csv')
dataSF <- st_as_sf(data, coords =c( 'Longitude', 'Latitude') , crs = '+proj=longlat +datum=WGS84 +no_defs')
expressway<- readShapeSpatial('RoadNetwork/roads_expressway')
sgmap <- st_read('data.gov.sg/planningArea', 'MP14_PLNG_AREA_WEB_PL')
dataSF_svy21 <- st_transform(dataSF, 3414)
accidents <- dataSF_svy21 %>% filter(Type == 'Accident')
tm_shape(sgmap) + tm_borders()  + tm_shape(accidents) + tm_symbols(size = 0.5)
accidents_xy <- read.csv('csv/accidents.csv')
accidents_ppp <- ppp(accidents_xy[,1], accidents_xy[,2], c(min(accidents_xy[,1]), max(accidents_xy[,1])), c(min(accidents_xy[,2]), max(accidents_xy[,2])))
plot(accidents_ppp)
summary(accidents_ppp)
plot(Kest(accidents_ppp))
plot(envelope(accidents_ppp,Kest))
plot(density(accidents_ppp))
expressway_psp <- as.psp(expressway)
expressway_linnet <- as.linnet.psp(expressway_psp, sparse = TRUE)
accidents_lpp <- lpp(accidents_ppp, expressway_linnet)
plot(density.lpp(accidents_lpp, 1000))
mce_kpe_camera <- st_read('data.gov.sg/mce-kpe-speed-camera-shp', 'MCE_KPE_SPEED_CAMERA')
mce_kpe_camera$Type <- 'MCE_KPE_Camera'
st_write(mce_kpe_camera, "csv/mce_kpe_camera.csv", layer_options = "GEOMETRY=AS_XY")
mce_kpe_camera_xy <- read.csv('csv/mce_kpe_camera.csv')
mce_kpe_camera_join <- select(mce_kpe_camera_xy, X, Y, Type )
accidents_join <- select(accidents_xy, X, Y, Type)
accidents_mce_kpe_cameras <- rbind(accidents_join, mce_kpe_camera_join)
accidents_mce_ppp <- ppp(accidents_mce_kpe_cameras[,1], accidents_mce_kpe_cameras[,2], c(min(accidents_mce_kpe_cameras[,1]), max(accidents_mce_kpe_cameras[,1])), c(min(accidents_mce_kpe_cameras[,2]), max(accidents_mce_kpe_cameras[,2])), marks = accidents_mce_kpe_cameras$Type)
accidents_mce_lpp <- lpp(accidents_mce_ppp, expressway_linnet)
linearKcross(accidents_mce_lpp, 'Accident' , 'MCE_KPE_Camera')
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
analysis_area <- 'BKE'
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
accidents_subset <- accidents[accidents@data$Accident_L == analysis_area,]
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
expressway_subset <- expressway[expressway@data$ref == analysis_area,]
library(readr)
library(sf)
trafficReport <- read_csv("data/LTATrafficDataClean2.csv")
trafficReport_shp <- st_as_sf(trafficReport, coords = c("Longitude", "Latitude"), crs = "+proj=longlat +datum=WGS84 +no_defs")
traffic_Report_svy21 <- st_transform(trafficReport_shp, crs = 3414)
View(accidents)
View(accidents)
testingfilter <- accidents %>% filter(PLN_AREA_N == "ANG MO KIO")
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
analysis_area <- 'BKE'
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
accidents_subset <- accidents[accidents@data$Accident_L == analysis_area,]
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
expressway_subset <- expressway[expressway@data$ref == analysis_area,]
analysis_area <- 'SLE'
# Prepare cameras
cameras_accidents <- readOGR('Cameras', 'cameras_accidents')
cameras_accidents_subset <- cameras_accidents[cameras_accidents@data$Expressway == analysis_area,]
cameras_accidents_sp <- as(cameras_accidents_subset, 'SpatialPoints')
cameras_accidents_ppp <- as.ppp(cameras_accidents_sp)
marks(cameras_accidents_ppp) <- cameras_accidents_subset@data$Type
#Prepare expressway
expressway_subset <- expressway[expressway@data$ref == analysis_area,]
data <- read_csv('csv/LTATrafficDataClean2.csv')
dataSF <- st_as_sf(data, coords =c( 'Longitude', 'Latitude') , crs = '+proj=longlat +datum=WGS84 +no_defs')
expressway<- readShapeSpatial('RoadNetwork/roads_expressway')
sgmap <- st_read('data.gov.sg/planningArea', 'MP14_PLNG_AREA_WEB_PL')
dataSF_svy21 <- st_transform(dataSF, 3414)
analysis_area <- 'BKE'
# Prepare accidents
accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
accidents_subset <- accidents[accidents@data$Accident_L == analysis_area,]
accidents_sp <- as(accidents_subset, 'SpatialPoints')
accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
expressway_subset <- expressway[expressway@data$ref == analysis_area,]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp)
#Create accidents lpp
accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
plot(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,10000)))
analysis_area <- 'SLE'
# Prepare cameras
cameras_accidents <- readOGR('Cameras', 'cameras_accidents')
cameras_accidents_subset <- cameras_accidents[cameras_accidents@data$Expressway == analysis_area,]
cameras_accidents_sp <- as(cameras_accidents_subset, 'SpatialPoints')
cameras_accidents_ppp <- as.ppp(cameras_accidents_sp)
marks(cameras_accidents_ppp) <- cameras_accidents_subset@data$Type
#Prepare expressway
expressway_subset <- expressway[expressway@data$ref == analysis_area,]
expressway_subset_psp <- as.psp(expressway_subset)
expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp)
#Create accidents lpp
cameras_accidents_lpp <- lpp(cameras_accidents_ppp, expressway_subset_linnet)
#Multitype K Function
linearKcross(cameras_accidents_lpp, 'Accident' , 'Camera')
plot(envelope.lpp(cameras_accidents_lpp,linearKcross, nsim = 50, i = 'Accident', j = 'Camera', r = seq(0,3000))) #, r = seq(0,3000)
library(rgdal)
library(polyCub) #install package polyCub
costaloutline <- readOGR("data/sg_map/CostalOutline.shp")
costaloutline_sp <- as(costaloutline, "SpatialPolygons")
costaloutline_owin <- as.owin.SpatialPolygons(costaloutline_sp)
costaloutline_mask <- as.mask(costaloutline_owin)
library(tidyverse)
library(spatstat)
accidents <- traffic_Report_svy21 %>% filter(Type == "Accident")
library(readr)
library(sf)
trafficReport <- read_csv("data/LTATrafficDataClean2.csv")
trafficReport_shp <- st_as_sf(trafficReport, coords = c("Longitude", "Latitude"), crs = "+proj=longlat +datum=WGS84 +no_defs")
traffic_Report_svy21 <- st_transform(trafficReport_shp, crs = 3414)
library(tidyverse)
library(spatstat)
accidents <- traffic_Report_svy21 %>% filter(Type == "Accident")
accidents_sp <- as(accidents, "Spatial")
heavytraffic <- traffic_Report_svy21 %>% filter(Type == "Heavy Traffic")
heavytraffic_sp <- as(heavytraffic, "Spatial")
accidents_ppp <- ppp(coordinates(accidents_sp)[,1], coordinates(accidents_sp)[,2], costaloutline_owin)
heavytraffic_ppp <- ppp(coordinates(heavytraffic_sp)[,1], coordinates(heavytraffic_sp)[,2], costaloutline_owin)
plot(accidents_ppp)
plot(heavytraffic_ppp)
library(maptools)
roadNetwork <- readShapeSpatial("data/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
plot(roadNetwork_linnet)
analysis_area <- 'BKE'
# Prepare accidents
# accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
# accidents_subset <- accidents[accidents@data$Accident_L == analysis_area,]
# accidents_sp <- as(accidents_subset, 'SpatialPoints')
# accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
# expressway_subset <- expressway[expressway@data$ref == analysis_area,]
# expressway_subset_psp <- as.psp(expressway_subset)
# expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp)
#Create accidents lpp
# accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
plot(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,10000)))
analysis_area <- 'BKE'
# Prepare accidents
# accidents <- readOGR('FinalAccidents', 'accidents_on_expressway')
# accidents_subset <- accidents[accidents@data$Accident_L == analysis_area,]
# accidents_sp <- as(accidents_subset, 'SpatialPoints')
# accidents_ppp <- as.ppp(accidents_sp)
#Prepare expressway
# expressway_subset <- expressway[expressway@data$ref == analysis_area,]
# expressway_subset_psp <- as.psp(expressway_subset)
# expressway_subset_linnet <- as.linnet.psp(expressway_subset_psp)
#Create accidents lpp
# accidents_lpp <- lpp(accidents_ppp, expressway_subset_linnet)
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#system.time(envelope.lpp(accidents_lpp,linearK, nsim = 99, r = seq(0,1,by=0.20)))
plot(density.lpp(accidents_lpp, 2000))
plot(envelope.lpp(accidents_lpp,linearK, nsim = 3, r = seq(0,10000)))
packages = c('tmap', 'sf', 'tidyverse', 'RColorBrewer', 'classInt', 'spatstat', 'rgdal', 'maptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
library(rgdal)
library(polyCub) #install package polyCub
costaloutline <- readOGR("data/sg_map/CostalOutline.shp")
costaloutline_sp <- as(costaloutline, "SpatialPolygons")
costaloutline_owin <- as.owin.SpatialPolygons(costaloutline_sp)
costaloutline_mask <- as.mask(costaloutline_owin)
library(tidyverse)
library(spatstat)
accidents <- readOGR(dsn = "Vincent_Project/FinalAccidents",  layer = "accidents_on_expressway")
accidents_sp <- as(accidents, 'SpatialPoints')
# accidents <- traffic_Report_svy21 %>% filter(Type == "Accident")
# accidents_sp <- as(accidents, "Spatial")
# heavytraffic <- traffic_Report_svy21 %>% filter(Type == "Heavy Traffic")
# heavytraffic_sp <- as(heavytraffic, "Spatial")
accidents_ppp <- ppp(coordinates(accidents_sp)[,1], coordinates(accidents_sp)[,2], costaloutline_owin)
# heavytraffic_ppp <- ppp(coordinates(heavytraffic_sp)[,1], coordinates(heavytraffic_sp)[,2], costaloutline_owin)
plot(accidents_ppp)
# plot(heavytraffic_ppp)
library(maptools)
roadNetwork <- readShapeSpatial("data/RoadNetwork/roads_expressway", CRS("+init=epsg:3414"))
roadNetwork_psp <- as.psp(roadNetwork, window=NULL, marks=NULL, check=spatstat.options("checksegments"), fatal=TRUE)
roadNetwork_linnet <- as.linnet.psp(roadNetwork_psp, sparse=TRUE)
plot(roadNetwork_linnet)
library(spatstat)
accidentskde <- density.lpp(accidents_lpp, sigma=1000)
accidents_lpp <- lpp(accidents_ppp, roadNetwork_linnet)
#heavytraffic_lpp <- lpp(heavytraffic_ppp, roadNetwork_linnet)
plot(accidents_lpp)
#plot(heavytraffic_lpp)
library(spatstat)
accidentskde <- density.lpp(accidents_lpp, sigma=1000)
accidentskde_ppp <- density.ppp(accidents_ppp, sigma=1000)
plot(accidentskde)
library(tmap)
library(tmaptools)
library(maptools)
library(rgdal)
library(raster)
accidentkde_sgdf <- as.SpatialGridDataFrame.im(accidentskde)
d <- raster(accidentkde_sgdf)
dd <- disaggregate(d, 50)
accidentkde_ppp_sgdf <- as.SpatialGridDataFrame.im(accidentskde_ppp)
proj4string(accidentkde_sgdf) = CRS("+init=epsg:3414")
proj4string(dd) = CRS("+init=epsg:3414")
proj4string(accidentkde_ppp_sgdf) = CRS("+init=epsg:3414")
tmap_mode("view")
tm_shape(dd) +
tm_raster()
